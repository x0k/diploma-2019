# Проектирование приложения для представления комплексных расписаний с использованием подходаProgressive Web Application

Представляю работу на тему Проектирование приложения для представления комплексных расписаний с использованием подходаProgressive Web Application

Для начала разберемся в основных понятиях упомянутых в теме доклада

# Основные понятия

## Progressive Web Application

Это группа веб-приложений использующих современные возможности веб-платформы, такие как:
* различные web-workers
* манифесты приложений
* пуш нотификации

Что позволяет им устранить недостатки классических веб-приложений и приблизиться по своим возможностям к нативным

## Комплексное расписание

Можно выделить два типа расписаний:
* Периодические - расписания, действия которых повторяются через конкретный промежуток времени (период)
* Непериодические - расписания, в которых отсутствуют требования обязательного повторения событий, через заданный промежуток времени

В теории пересечение данных множеств должно быть пустым множеством, но на практике это не так и можно выделить третий тип расписаний – комплексные

Давайте рассмотрим пример

## Пример комплексное расписание

Представленное можно назвать периодическим, однако для достижения это был введен ряд условностей:
* Режимы недели
* Предметы с конкретными датами
* Предметы с датами исключениями

Использовать данное расписание напрямую невозможно, необходимо как минимум знать режим недели и иметь в виду ограничения конкретных предметов.
Очевидно, что данный формат не является оптимальным для восприятия, давайте попробуем его изменить.

## Представление расписания

Можно подумать, предыдущее представление несет гораздо больше информации и сравнивать данные представления некорректно
Однако на конкретную дату и для конкретной подгруппы, представления имеют одинаковую ценность
Далее будем иметь ввиду под представлением расписания - выборку необходимой информации из существующего расписания

# Что такое расписание?

По сути расписание – это упорядоченная по времени информация о предстоящих событиях
Тогда мы можем представить расписание в виде функции определенной на временной прямой и возвращающую информацию о текущем событии
Используя данную идею остается лишь вычислить данную функцию и использовать ее для отображения расписания

# Представление расписания

## Генерация функции расписания

Был разработан DSL позволяющий описывать шаблоны функций, по которым могут быть построены композиции нативных функций.
Используя данный DSL на основе входных данных генерируются шаблоны позволяющие вычислять значения атрибутов событий.

Слева представлены входные данные.
Справа - функция созданная на основе этих данных для вычисления состояния атрибута комната

Логическое выражение, если день или пн или ср и звонок 6 или 7, то атрибут кабинет принимает значение 123

## Временной интервал

Также для представления расписания необходимо выбрать временной интервал, на котором будет вычислена функция расписания.
Указав оптимальный временной интервал можно значительно сократить количество вычислений, например для учебного расписания:
- не нужно рассчитывать события по воскресениям
- исключение праздничных дней
- время с 10 вечера до 8 утра
- можно вычислять состояние расписания каждые 10 минут

Для оптимального применения такого рода ограничений, временной период можно представить в виде дискретной иерархической структуры и применять соответствующее ограничение на необходимом уровне.

## Генератор событий

Далее вступает в работу генератор событий.

Он выстраивает функции вычисления значения атрибута события согласно их зависимостям, затем последовательно вычисляет их, добавляя вычисленное значение к начальному состоянию.

По окончанию получается объект описывающий состояние расписания на конкретный момент.

## Группировщик событий

Даже используя оптимальный временной период, высока вероятность того, что вычисленные состояния будут описывать одно и тоже событие.
Для объединения одинаковых состояний с различными датами применяется группировщик.
Он производит объединение на основе сравнения значений атрибутов события и временного промежутка между ними.

# Применение

Используя вышеперечисленные компоненты было реализовано клиентское веб-приложение, позволяющее:
- генерировать функцию расписания на основе в данных о расписании
- просматривать различные расписания в списочном виде используя различные способы группировки